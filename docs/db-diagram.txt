Table organizations {
  id uuid [pk, not null]
  name varchar(255) [not null]
  slug varchar(1024) [not null, unique]
  logo_url varchar(1024)
  
  created_at timestamp [not null]
  created_by varchar(255) [not null]
  updated_at timestamp
  updated_by varchar(255)
  archived_at timestamp
  archived_by varchar(255)
}

Table users {
  id uuid [pk, not null]
  first_name varchar(255) [not null]
  last_name varchar(255) [not null]
  email varchar(320) [not null, unique]
  
  created_at timestamp [not null]
  created_by varchar(255) [not null]
  updated_at timestamp
  updated_by varchar(255)
  archived_at timestamp
  archived_by varchar(255)
}

Table user_organization_accesses {
  id uuid [pk, not null]
  user_id uuid [not null, ref:> users.id]
  organization_id uuid [not null, ref:> organizations.id]
  capability_name varchar(1024) [not null]
  
  created_at timestamp [not null]
  created_by varchar(255) [not null]
  updated_at timestamp
  updated_by varchar(255)
  archived_at timestamp
  archived_by varchar(255)
  
  synced_at timestamp
  
  indexes {
    (user_id, organization_id, capability_name) [unique]
  }
}

Table user_global_accesses {
  id uuid [pk, not null]
  user_id uuid [not null, ref:> users.id]
  capability_name varchar(1024) [not null]
  
  created_at timestamp [not null]
  created_by varchar(255) [not null]
  updated_at timestamp
  updated_by varchar(255)
  archived_at timestamp
  archived_by varchar(255)
  
  synced_at timestamp
  
  indexes {
    (user_id, capability_name) [unique]
  }
}

Table organization_settings {
  organization_id uuid [pk, ref:- organizations.id]
  receipt_template_id uuid [ref:- templates.id]
  email_no_address_reminder_template_id uuid [ref:> templates.id]
  email_receipt_template_id uuid [ref:> templates.id]
  smtp_options jsonb
  
  updated_at timestamp
  updated_by varchar(255)
}

Table templates {
  id uuid [pk, not null]
  organization_id uuid [ref:> organizations.id]
  name varchar(1024) [not null]
  template text [not null]
  
  // Email (MJML) or Document (HBS)
  template_type varchar(50) [not null]
  
  created_at timestamp [not null]
  created_by varchar(255) [not null]
  updated_at timestamp
  updated_by varchar(255)
  archived_at timestamp
  archived_by varchar(255)
}

Table receipt_template_values {
  id uuid [pk, not null]
  template_id uuid [not null, ref:> templates.id]
  type varchar(50) [not null]
  key varchar(255) [not null]
  
  value text
  translations jsonb
}

Table donations {
  id uuid [pk, not null]
  organization_id uuid [not null, ref: > organizations.id]
  donor_firstname varchar(255)
  donor_lastname varchar(255) [not null]
  donor_email varchar(320)
  fiscal_year varchar(4) [not null]
  reason varchar(255)
  type varchar(50) [not null]
  
  auto_send_receipt boolean [default: true]
  
  created_at timestamp [not null]
  created_by varchar(255) [not null]
  updated_at timestamp
  updated_by varchar(255)
  archived_at timestamp
  archived_by varchar(255)
}

Table donor_address {
  donation_id uuid [pk, not null, ref:- donations.id]
  line1 varchar(255)
  line2 varchar(255)
  city varchar(255)
  state varchar(255)
  postal_code varchar(32)
  country varchar(255)
}

Table donation_payments {
  id uuid [pk, not null]
  donation_id uuid [not null, ref:> donations.id]
  amount_in_currency_unit integer [not null]
  currency varchar(3) [not null]
  receipt_amount_in_currency_unit integer [not null]
  source varchar(255) [not null]
  source_details jsonb
  
  created_at timestamp [not null]
  created_by varchar(255) [not null]
  updated_at timestamp
  updated_by varchar(255)
  archived_at timestamp
  archived_by varchar(255)
}

Table donation_documents {
  id uuid [pk, not null]
  donation_id uuid [not null, ref:> donations.id]
  name varchar(255) [not null]
  description varchar(1024)
  template_name varchar(1024)
  
  generation_status varchar(255) [not null]
  
  created_at timestamp [not null]
  created_by varchar(255) [not null]
  archived_at timestamp
  archived_by varchar(255)
}

Table donation_comments {
  id uuid [pk, not null]
  donation_id uuid [not null, ref:> donations.id]
  
  comment text [not null]
  
  created_at timestamp [not null]
  created_by varchar(255) [not null]
  updated_at timestamp
  updated_by varchar(255)
  archived_at timestamp
  archived_by varchar(255)
}

Table donation_correspondences {
  id uuid [pk, not null]
  donation_id uuid [not null, ref:> donations.id]
  sent_to varchar(320) [not null]
  status varchar(50) [not null]
  type varchar(255) [not null]
  
  template_name varchar(1024)
  
  created_at timestamp [not null]
  created_by varchar(255) [not null]
}

Table donation_correspondence_attachments {
  id uuid [pk, not null]
  donation_correspondence_id uuid [not null, ref:> donation_correspondences.id]
  donation_document_id uuid [not null, ref:> donation_documents.id]
}

